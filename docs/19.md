# 十九、和的分布

> 原文：[prob140/textbook/notebooks/ch19](https://nbviewer.jupyter.org/github/prob140/textbook/blob/gh-pages/notebooks/Chapter_19/)
> 
> 译者：[平淡的天](https://github.com/friedhelm739)
> 
> 协议：[CC BY-NC-SA 4.0](http://creativecommons.org/licenses/by-nc-sa/4.0/)
> 
> 自豪地采用[谷歌翻译](https://translate.google.cn/)

# 本章所需python包 #
```python
# HIDDEN
from datascience import *
from prob140 import *
import numpy as np
import matplotlib.pyplot as plt
plt.style.use('fivethirtyeight')
%matplotlib inline
import math
from scipy import stats
```

本章提供了一些离散变量和连续变量处理随机变量和的一般方法。

我们将从连续模拟用于分配两个独立的离散随机变量之和卷积公式开始。

然后，我们将开发一个更强大的概率生成函数版本，我们之前定义它来研究具有有限多个非负整数值的独立随机变量的总和。新版本被称为矩生成函数，它将应用于离散和连续随机变量，其具有有限或无限的可能值集。

##卷积公式
我们令`X`和`Y`为两个离散变量，且令`S=X+Y`。我们知道找到`S`分布一种好的方式就是根据`X`的值去划分事件`{S=s}`。即：

$$P(S=s)=\sum_{}^{all x}$(X=x,Y=s-x)$$

如果`X`和`Y`是独立的，那么上一步公式变为离散卷积公式：

$$P(S=s)=\sum_{}^{all x}$P(X=x)P(Y=s-x)$$

这个公式有一个直接的连续模拟。令`X`和`Y`为联合密度为`f`的连续随机变量，令`S=X+Y`。则`S`的密度为：

$$f_{s}(s)=\int_{-\infty }^{\infty }f(x,s-x)dx$$

则当`X`和`Y`独立时公式变为卷积公式：

$$f_{s}(s)=\int_{-\infty }^{\infty }f_{X}(x)f_{Y}(s-x)dx$$

###两个独立同分布指数随机变量的和

令`X`和`Y`为独立同分布指数`（λ）`随机变量，令`S=X+Y`。对于`s>0`的和，`X`和`Y`都不能超过`s`。卷积公式显示`S`的密度为：

$$f_{s}(s)=\int_{0}^{s }\lambda e^{-\lambda x}\lambda e^{-\lambda (s-x)}dx
=\lambda ^{2}e^{-\lambda s}\int_{0}^{s }dx=\lambda ^{2}se^{-\lambda s}$$

这是`伽玛(2,λ)`密度，与前一章关于独立伽马随机变量之和的说法一致。

有时，可以在没有卷积公式的情况下找到和的密度。

##两个独立同分布二项分布`(0,1)`随机变量的和

令$$S=U_{1}+U_{2}$$,其中$$U_{i}$$为独立同分布二项分布`(0,1)`。下图中的金条显示了各种`S`值的事件`S∈ds`。

```python
# NO CODE
plt.plot([0, 1], [1, 1], color='k', lw=2)
plt.plot([1, 1], [0, 1], color='k', lw=2)
plt.plot([0, 1], [0, 0], color='k', lw=2)
plt.plot([0, 0], [0, 1], color='k', lw=2)
plt.plot([0.005, 0.25], [0.25, 0.005], color='gold', lw=4)
plt.plot([0.005, 0.995], [0.995, 0.005], color='gold', lw=4)
plt.plot([0.405, 0.995], [0.995, 0.405], color='gold', lw=4)
plt.ylim(-0.05, 1.05)
plt.xlim(-0.05, 1.05)
plt.axes().set_aspect('equal')
plt.xlabel('$U_1$')
plt.ylabel('$U_2$', rotation=0);
```

![19-1](../img/19-1.png)

联合密度表面是平坦的。 因此，`S`的密度形状仅取决于条纹的长度，其在`s=0`和`s=1`之间线性增加，然后在`s=1`和`s=2`之间线性减小。 所以`S`的联合密度是三角形的。三角形的高度为1，因为三角形的面积为1。

```python
# NO CODE
plt.plot([0, 1], [1, 1], color='k', lw=2)
plt.plot([1, 1], [0, 1], color='k', lw=2)
plt.plot([0, 1], [0, 0], color='k', lw=2)
plt.plot([0, 0], [0, 1], color='k', lw=2)
plt.plot([0.005, 0.25], [0.25, 0.005], color='gold', lw=4)
plt.plot([0.005, 0.995], [0.995, 0.005], color='gold', lw=4)
plt.plot([0.405, 0.995], [0.995, 0.405], color='gold', lw=4)
plt.ylim(-0.05, 1.05)
plt.xlim(-0.05, 1.05)
plt.axes().set_aspect('equal')
plt.xlabel('$U_1$')
plt.ylabel('$U_2$', rotation=0);
```

![19-2](../img/19-2.png)

有时卷积公式中的积分可能非常难以处理。在本章的其余部分，我们将开发一种不同的方法来推导和的分布。

##矩生成函数

概率质量函数和概率密度，cdf和生存函数都是指定随机变量的概率分布的方法。 它们都被定义为概率或每单位长度的概率，因此具有自然的解释和可视化。

但是也有更抽象的方式来描述分布，例如我们为具有有限多个非负整数值的随机变量定义的概率生成函数（pgf）。

我们现在定义另一个这样的分布变换。 它比pgf更通用，是研究分布的有力工具。

设`X`是随机变量。`X`的矩生成函数（mgf）是通过公式在实数上定义的函数：

$$M_{X}(t)=E(e^{tX})$$

对于所有t期望是有限的。 事实（我们不会证明）mgf的域必须是一个区间，不一定是有限的，但必然包括0，因为$$M_{X}(0)=1$$

对于具有有限多个非负整数值的`X`，我们已经通过$$G_{X}(s)=E(s^{X})$$定义了pgf。 请注意，这是当$$s)=e^{t}$$时mgf的特殊情况，因此为正。对于同时具有pgf $$G_{X}$$和mgf $$M_{X}$$的随机变量`X`，这两个函数通过$$G_{X}(log(s))=G_{X}E(s)$$相关。因此,$$M_{X}$$接近0的属性反映了 $$G_{X}$$在1附近的属性。

本节介绍了mgf有用的三种方法。 其他方式将在本章的后续章节中进行说明。 我们所说的关于mgf的大部分内容都不会附带完整的证明，因为所需的数学超出了本课程的范围。 但即使没有正式的证明，结果也是合理的。

我们将首先列出三种方法，然后在示例中使用它们。

###产生矩

对于非负整数k，期望$$E(X^{k})$$被称为`X`的第k个矩。您在数据8中看到并且在该过程中再次看到平均$$E(X)$$是`X`的概率直方图的重心。在物理学中，质心被称为一阶矩。 矩的术语也用于概率论。

在这个过程中，我们只能使用在0左右的某个区间内有限的mgf。区间可以是整个实线。实际上，如果mgf在0附近是有限的（不仅仅是0的一侧），那么所有的时刻都存在。

展开$$e^{tX}$$可得到：
$$M_{X}(t)=E(1+t\frac{X}{1!}+t^{2}\frac{X^{2}}{2!}+t^{3}\frac{X^{3}}{3!}+...)=1+t\frac{E(X)}{1!}+t^{2}\frac{E(X^{2})}{2!}+t^{3}\frac{E(X^{3})}{3!}+...$$

暂且放下关于我们是否可以将无限和与其他操作切换的问题。继续对$$M_{X}$$求导。设$$M_{X}^{n}$$表示第n个导数。可得

$$M_{X}^{(1)}(t)=\frac{d}{dt}M_{X}(t\frac{E(X)}{1!}+2t\frac{E(X^{2})}{2!}+3t^{2}\frac{E(X^{3})}{3!}+...$$

因此

$$M^{(1)}(0)=E(X)$$

对$$M^{(1)}(0)$$积分得到$$M^{(2)}(0)=E(X^{2})$$，以此类推

$$M^{(n)}(0)=E(X^{n}),n=1,2,3...$$

因此，我们可以通过在t = 0时评估$$M_{X}$$的连续导数来生成`X`的矩。 这是mgf有用的一种方式。

###识别分布

在本课程中，我们大量使用了一阶矩和二阶矩，并没使用高阶矩。情况将继续如此。但是mgf确实涉及所有时刻，这导致了一个对于证明分布事实非常有用的属性：

如果两个分布具有相同的mgf，则它们必须是相同的分布。例如，如果将随机变量的mgf识别为正态分布的mgf，则随机变量必须是正态的。

相反，如果您知道随机变量的期望，则无法识别随机变量的分布;即使你知道平均值和SD（相当于一阶矩和二阶矩），你也无法识别分布。但是如果你知道生成函数，那么你就可以识别。

如果mgf存在于0左右的区间内，则此属性有效，我们在本节前面已假设。

mgf确定分布是mgf有用的另一个原因。

###与和的良好合作

mgf有用的第三个原因是，与pgf一样，独立随机变量之和的mgf很容易计算为乘积。

令`X`和`Y`独立，则：

$$M_{X+Y}(t)=E(e^{t(X+Y)})=E(e^{tX}\cdot e^{tY})$$

所以如果`X`和`Y`独立，

$$M_{X+Y}(t)=M_{X}(t)M_{Y}(t)$$

现在是举一些例子的时候了。 请记住，`X`的mgf是`X`的函数的期望。 在某些情况下，我们将使用非线性函数规则计算它以获得期望值。 在其他情况下，我们将使用独立随机变量之和的mgf的乘法性质。

###一切离散随机变量的mgf

伯努利(p)

P(X=1)=p并且P(X=0)=1-p=q。所以对于所有t

$$M_{X}(t)=qe^{t\cdot 0}+qe^{t\cdot 1}=q+pe^{t}=1-p(e^{t}-1)$$

二项分布(n,p)

一个二项分布随机变量是n个独立同分布变量之和，所以对于所有t

$$M_{X}(t)=(q+pe^{t})^{n}$$

泊松分布(μ)

这是一个练习。对于所有t

$$M_{X}(t)=e^{μ(e^{t}-1)}$$

您还可以使用它来显示独立泊松变量的总和是泊松。

###伽玛(r,λ)随机分布的mgf

令`X`有伽玛(r,λ)分布，则：

$$M_{X}(t)=\int_{0}^{\infty }e^{tx} \frac{\lambda ^{r}}{\Gamma (r)}x^{r-1}e^{-\lambda x}dx=\frac{\lambda ^{r}}{\Gamma (r)}\int_{0}^{\infty } x^{r-1}e^{-(\lambda-t) x}dx=\frac{\lambda ^{r}}{\Gamma (r)}\cdot \frac{\Gamma (r)}{(\lambda -t)^r}=(\frac{\lambda }{\lambda -t})^{r}$$

####具有相同率的独立伽玛变量的和

如果`X`是伽玛(r,λ)分布且独立于`X`的`Y`也是伽玛(r,λ)分布，则：

$$M_{X+Y}(t)=(\frac{\lambda }{\lambda -t)^{r}\cdot (\frac{\lambda }{\lambda -t)^{s}=(\frac{\lambda }{\lambda -t})^{r+s}$$

这是伽马(r+s,λ)分布的mgf。 因为mgf识别分布，所以`X+Y`必须具有伽马(r+s,λ)分布。




$$E(X^{k})$$
`Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y``Y`

